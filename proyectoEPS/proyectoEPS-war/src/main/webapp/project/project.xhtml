<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="../templates/template-one.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
                xmlns:jsf="http://xmlns.jcp.org/jsf"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:o="http://omnifaces.org/ui"
                xmlns:cmp="http://xmlns.jcp.org/jsf/composite/components"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <f:metadata>
        <o:viewParam name="idProcess" required="true" 
                     value="#{projectView.processId}"
                     requiredMessage="Ningun valor">
            <o:viewParamValidationFailed sendError="404" message="Error parametro"/>
        </o:viewParam>
        <o:viewAction action="#{projectView.loadCurrentProject()}" />
    </f:metadata>

    <ui:define name="head">
        Anteproyecto
    </ui:define>

    <ui:define name="title">
        Anteproyecto
    </ui:define>

    <ui:define name="content">
        <h:outputScript library="js" name="calendar_es.js" />
        <h:form id="formProject">
            <fieldset>
                <legend>Anteproyecto</legend> 
                <div class="row">
                    <div class="form-group col-md-8">
                        <p:outputLabel class="text-danger" value="Advertencia:   No se puede revisar este proyecto debido a que no es el primero en la cola de revision." rendered="#{projectView.renderWarningCoordinator()}"/>
                        <p:outputLabel class="text-danger" value="Advertencia:   No se puede editar el proyecto debido a que se encuentra en un proceso de revision." rendered="#{projectView.stateRevision()}"/><br></br><br></br>
                        <p:outputLabel for="title" value="Titulo:"/>
                        <p:inputText id="title" styleClass="form-control" pt:placeholder="Titulo del Proyecto"
                                     disabled="#{!projectView.isStuden() or (projectView.process.state==projectView.revisionState)}"
                                     pt:required="true"
                                     value="#{projectView.project.title}"/><br></br>

                        <p data-placement="top" data-toggle="tooltip" title="comentar">
                            <p:commandLink class="#{projectView.correctionTitle.style}"
                                           oncomplete="PF('dlgCmt').show();"
                                           update=":#{p:component('dlgCmt')}"
                                           rendered="#{projectView.showButtonRevision(projectView.correctionTitle)}">
                                <f:setPropertyActionListener value="#{projectView.correctionTitle}" target="#{projectView.correctionSelected}"/>
                                <span class="glyphicon glyphicon-eye-open"></span> #{projectView.textObser}
                            </p:commandLink>
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-8">
                        <p:panel header="Objetivos Generales" id="generalObjectives" >
                            <p:dataView value="#{projectView.generalObjectves}" var="generalObjective" rowIndexVar="generalObjectiveStatus">
                                <p:dataViewListItem>
                                    <div class="row">
                                        <div class="form-group col-sm-10">
                                            <p:inputText pt:placeholder="Objetivo General" 
                                                         disabled="#{!projectView.isStuden() or (projectView.process.state==projectView.revisionState)}"
                                                         value="#{generalObjective.text}"
                                                         class="form-control"
                                                         >
                                            </p:inputText>
                                        </div>
                                        <div class="form-group col-sm-2">
                                            <p:commandLink  styleClass="btn btn-danger"  actionListener="#{projectView.removeGeneralOBjectives(generalObjectiveStatus)}" 
                                                            rendered="#{projectView.isStuden() and (projectView.process.state!=projectView.revisionState)}"
                                                            update="#{p:component('generalObjectives')}"
                                                            process="#{p:component('generalObjectives')}"
                                                            >
                                                <span class="glyphicon glyphicon-minus"></span> Eliminar
                                            </p:commandLink>
                                        </div>
                                    </div>    
                                </p:dataViewListItem>
                            </p:dataView>
                            <p:commandLink styleClass="btn btn-success" actionListener="#{projectView.addGeneralObjectives()}" update="generalObjectives, growl"
                                           process="#{p:component('generalObjectives')}"
                                           rendered="#{projectView.isStuden() and (projectView.process.state!=projectView.revisionState)}"
                                           >
                                <span class="glyphicon glyphicon-plus"></span> Agregar
                            </p:commandLink>
                        </p:panel>
                        <br></br><p:commandLink class="#{projectView.correctionObjetives.style}" 
                                                rendered="#{projectView.showButtonRevision(projectView.correctionObjetives)}"
                                                oncomplete="PF('dlgCmt').show();"
                                                update=":#{p:component('dlgCmt')}"
                                                >
                            <f:setPropertyActionListener value="#{projectView.correctionObjetives}" target="#{projectView.correctionSelected}"/>
                            <span class="glyphicon glyphicon-eye-open"></span> #{projectView.textObser}
                        </p:commandLink>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-8">
                        <p:panel header="Objetivos Especificos" id="specificObjectives" >
                            <p:dataView value="#{projectView.specificObjectives}" var="specificObjective" rowIndexVar="specificObjectiveStatus">
                                <p:dataViewListItem>
                                    <div class="row">
                                        <div class="form-group col-sm-10">
                                            <p:inputText pt:placeholder="Objetivo Especifico" 
                                                         disabled="#{!projectView.isStuden() or (projectView.process.state==projectView.revisionState)}"
                                                         value="#{specificObjective.text}"
                                                         class="form-control"
                                                         >
                                            </p:inputText>
                                        </div>
                                        <div class="form-group col-sm-2">
                                            <p:commandLink  styleClass="btn btn-danger" actionListener="#{projectView.removeSpecificOBjectives(specificObjectiveStatus)}" 
                                                            update="#{p:component('specificObjectives')}"
                                                            process="#{p:component('specificObjectives')}"
                                                            rendered="#{projectView.isStuden() and (projectView.process.state!=projectView.revisionState)}"
                                                            >
                                                <span class="glyphicon glyphicon-minus"></span> Eliminar
                                            </p:commandLink>
                                        </div>
                                    </div>    
                                </p:dataViewListItem>
                            </p:dataView>
                            <p:commandLink styleClass="btn btn-success" actionListener="#{projectView.addSpecificObjectives()}" update="specificObjectives, growl"
                                           process="#{p:component('specificObjectives')}"
                                           rendered="#{projectView.isStuden() and (projectView.process.state!=projectView.revisionState)}"
                                           >
                                <span class="glyphicon glyphicon-plus"></span> Agregar
                            </p:commandLink>
                        </p:panel>
                        <br></br><p:commandLink class="#{projectView.correctionSpecificObjetives.style}" 
                                                rendered="#{projectView.showButtonRevision(projectView.correctionSpecificObjetives)}"
                                                title="Realizar Comentario"
                                                oncomplete="PF('dlgCmt').show();"
                                                update=":#{p:component('dlgCmt')}"
                                                >
                            <f:setPropertyActionListener value="#{projectView.correctionSpecificObjetives}" target="#{projectView.correctionSelected}"/>
                            <span class="glyphicon glyphicon-eye-open"></span> #{projectView.textObser}
                        </p:commandLink>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-8">
                        <p:panel id="listSections" header="Secciones">
                            <div class="row">
                                <div class="form-group col-md-12">
                                    <p:dataView value="#{projectView.project.sections}" var="section" rowIndexVar="sectionStatus">
                                        <p:dataViewListItem>
                                            <div class="row">
                                                <div class="form-group col-md-12">
                                                    <p:panel id="Section">
                                                        <div class="row">
                                                            <div class="form-group col-md-12">
                                                                <p:outputLabel for="titleSection" value="Titulo:"/>
                                                                <p:inputText id="titleSection" styleClass="form-control" pt:placeholder="Titulo" disabled="#{!projectView.isStuden() or (projectView.process.state==projectView.revisionState)}"
                                                                             value="#{section.title.name}"
                                                                             />
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="form-group col-md-12">
                                                                <p:textEditor height="300"
                                                                              pt:disabled="#{!projectView.isStuden() or (projectView.process.state==projectView.revisionState)}"
                                                                              style="margin-bottom:10px" 
                                                                              readonly="#{projectView.stateRevision()}"
                                                                              placeholder="Ingrese su Contenido"
                                                                              value="#{section.title.texto.text}"
                                                                              >
                                                                    <f:facet name="toolbar">
                                                                        <span class="ql-formats">
                                                                            <button class="ql-bold"></button>
                                                                            <button class="ql-italic"></button>
                                                                            <button class="ql-underline"></button>
                                                                            <button class="ql-strike"></button>
                                                                        </span>
                                                                        <span class="ql-formats">
                                                                            <select class="ql-color" />
                                                                            <select class="ql-background" />
                                                                        </span>
                                                                        <span class="ql-formats">
                                                                            <button class="ql-script" value="sub" />
                                                                            <button class="ql-script" value="super" />
                                                                        </span>
                                                                        <span class="ql-formats">
                                                                            <button class="ql-list" value="ordered" />
                                                                            <button class="ql-list" value="bullet" />
                                                                            <button class="ql-indent" value="-1" />
                                                                            <button class="ql-indent" value="+1" />
                                                                        </span>
                                                                    </f:facet>
                                                                </p:textEditor>                                                            
                                                            </div>                                                        
                                                        </div>
                                                        <div class="row">
                                                            <div class="form-group col-md-12">
                                                                <cmp:titleChildren parentTitle="#{section.title}"/>
                                                            </div>                                                        
                                                        </div>
                                                        <div class="row">
                                                            <div class="form-group col-sm-3">
                                                                <p:commandLink  styleClass="btn btn-danger" actionListener="#{projectView.removeSection(sectionStatus)}" 
                                                                                update="#{p:component('listSections')}, :growl"
                                                                                process="#{p:component('listSections')}"
                                                                                rendered="#{projectView.isStuden() and (projectView.process.state!=projectView.revisionState)}"
                                                                                >
                                                                    <span class="glyphicon glyphicon-minus"></span> Eliminar Sección
                                                                </p:commandLink>
                                                                <br></br><br></br>
                                                                <p data-placement="top" data-toggle="tooltip" title="comentar">
                                                                    <p:commandLink class="#{projectView.getCorrectionSection(section).style}"
                                                                                   oncomplete="PF('dlgCmt').show();"
                                                                                   update=":#{p:component('dlgCmt')}"
                                                                                   rendered="#{projectView.showButtonRevision(projectView.getCorrectionSection(section))}"
                                                                                   >                                                                        <f:setPropertyActionListener value="#{projectView.getCorrectionSection(section)}" target="#{projectView.correctionSelected}"/>
                                                                        <span class="glyphicon glyphicon-eye-open"></span> #{projectView.textObser}
                                                                    </p:commandLink>
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </p:panel>
                                                </div>
                                            </div>
                                        </p:dataViewListItem>
                                    </p:dataView>
                                    <p:commandLink styleClass="btn btn-success" actionListener="#{projectView.project.addSection()}" update="listSections"
                                                   process="#{p:component('listSections')}"
                                                   rendered="#{projectView.isStuden() and (projectView.process.state!=projectView.revisionState)}"
                                                   >
                                        <span class="glyphicon glyphicon-plus"></span> Agregar Sección
                                    </p:commandLink>
                                </div>
                            </div>
                        </p:panel>
                    </div>
                </div>
                <div class="row" >
                    <div class="form-group col-md-8" >
                        <p:panel id="coordinatesDecimal" header="Coordenadas Decimales">
                            <p:dataView value="#{projectView.project.decimalCoordinates}" var="decimalCoordinate" rowIndexVar="decimalCoordinateStatus" >
                                <p:dataViewListItem>
                                    <div class="row">
                                        <div class="form-group col-sm-4">
                                            <p:inputNumber placeholder="Latitud" 
                                                           readonly="#{projectView.stateRevision()}"
                                                           decimalPlaces="4" 
                                                           value="#{decimalCoordinate.latitude}"                                                      
                                                           >
                                            </p:inputNumber>
                                        </div>                                   
                                        <div class="form-group col-sm-4">
                                            <p:inputNumber placeholder="Longitud" 
                                                           decimalPlaces="4"
                                                           readonly="#{projectView.stateRevision()}"
                                                           value="#{decimalCoordinate.longitude}"
                                                           >
                                            </p:inputNumber>
                                        </div>
                                        <div class="form-group col-sm-3">
                                            <p:commandLink  styleClass="btn btn-danger" actionListener="#{projectView.project.removeDecimalCoordinates(decimalCoordinateStatus)}" 
                                                            update="#{p:component('coordinatesDecimal')}"
                                                            process="#{p:component('coordinatesDecimal')}"
                                                            rendered="#{projectView.isStuden() and (projectView.process.state!=projectView.revisionState)}"
                                                            >
                                                <span class="glyphicon glyphicon-minus"></span> Eliminar
                                            </p:commandLink>
                                        </div>
                                    </div> 
                                </p:dataViewListItem>
                            </p:dataView>
                            <p:commandLink styleClass="btn btn-success" actionListener="#{projectView.project.addDecimalCoordinates()}" update="coordinatesDecimal"
                                           process="#{p:component('coordinatesDecimal')}"
                                           rendered="#{projectView.isStuden() and (projectView.process.state!=projectView.revisionState)}"
                                           >
                                <span class="glyphicon glyphicon-plus"></span> Agregar
                            </p:commandLink>
                        </p:panel>
                        <br></br><p:commandLink class="#{projectView.correctionCoordinates.style}"
                                                rendered="#{projectView.showButtonRevision(projectView.correctionCoordinates)}"                                                title="Realizar Comentario"
                                                oncomplete="PF('dlgCmt').show();"
                                                update=":#{p:component('dlgCmt')}"
                                                >
                            <f:setPropertyActionListener value="#{projectView.correctionCoordinates}" target="#{projectView.correctionSelected}"/>
                            <span class="glyphicon glyphicon-eye-open"></span> #{projectView.textObser}
                        </p:commandLink>
                    </div>
                </div>

                <div class="row">
                    <div class="form-group col-sm-8">
                        <p:outputLabel for="schedule" value="Calendario"/>
                        <p:fileUpload id="schedule" fileUploadListener="#{projectView.handleSchedule}"
                                      rendered="#{projectView.isStuden() and (projectView.process.state!=projectView.revisionState)}"
                                      required="true"
                                      skinSimple="true" auto="true"
                                      label="Seleccionar"
                                      update="labelSchedule"
                                      sizeLimit="15000000"
                                      allowTypes="/(\.|\/)(pdf)$/"
                                      invalidFileMessage="Solo se puede cargar archivos pdf"
                                      invalidSizeMessage="Archivo demasiado grande, limite de 14MB"
                                      >                                       
                        </p:fileUpload>
                        <h:commandLink id="labelSchedule" value="#{projectView.sheduleFileName}" class="text-primary"
                                       target="_blank" actionListener="#{projectView.reloadSchedule()}">
                            <p:fileDownload value="#{projectView.scheduleStream}" contentDisposition="inline"/>
                        </h:commandLink>
                        <br></br><br></br><p:commandLink class="#{projectView.correctionCalendar.style}"
                                                         rendered="#{projectView.showButtonRevision(projectView.correctionCalendar)}"
                                                         title="Realizar Comentario"
                                                         oncomplete="PF('dlgCmt').show();"
                                                         update=":#{p:component('dlgCmt')}"
                                                         >
                            <f:setPropertyActionListener value="#{projectView.correctionCalendar}" target="#{projectView.correctionSelected}"/>
                            <span class="glyphicon glyphicon-eye-open"></span> #{projectView.textObser}
                        </p:commandLink>
                    </div>
                </div>

                <div class="row">
                    <div class="form-group col-sm-8">
                        <p:outputLabel for="investmentPlan" value="Plan de Inversión"/>
                        <p:fileUpload id="investmentPlan" fileUploadListener="#{projectView.handleInvestmentPlan}"
                                      required="true"
                                      rendered="#{projectView.isStuden() and (projectView.process.state!=projectView.revisionState)}"
                                      skinSimple="true" auto="true"
                                      label="Seleccionar"
                                      update="labelInvestmentPlan"
                                      sizeLimit="15000000"
                                      allowTypes="/(\.|\/)(pdf)$/"
                                      invalidFileMessage="Solo se puede cargar archivos pdf"
                                      invalidSizeMessage="Archivo demasiado grande, limite de 14MB"
                                      >                                       
                        </p:fileUpload>
                        <h:commandLink id="labelInvestmentPlan" value="#{projectView.investmentPlanFileName}" class="text-primary"
                                       target="_blank" actionListener="#{projectView.reloadInvestmentPlan()}">
                            <p:fileDownload value="#{projectView.investmentPlanStream}" contentDisposition="inline"/>
                        </h:commandLink>
                        <br></br><br></br><p:commandLink class="#{projectView.correctionPlan.style}"
                                                         rendered="#{projectView.showButtonRevision(projectView.correctionPlan)}"
                                                         title="Realizar Comentario"
                                                         oncomplete="PF('dlgCmt').show();"
                                                         update=":#{p:component('dlgCmt')}"
                                                         >
                            <f:setPropertyActionListener value="#{projectView.correctionPlan}" target="#{projectView.correctionSelected}"/>
                            <span class="glyphicon glyphicon-eye-open"></span> #{projectView.textObser}
                        </p:commandLink>
                    </div>                    
                </div>

                <div class="row">
                    <div class="form-group col-md-8">
                        <p:panel id="biblioghraphies" header="Bibliografía">
                            <p:dataView value="#{projectView.project.bibliographies}" var="bibliography" rowIndexVar="bibliographyStatus">
                                <p:dataViewListItem>
                                    <div class="row">
                                        <div class="form-group col-sm-4">
                                            <p:inputText readonly="#{projectView.stateRevision()}" placeholder="Autor" value="#{bibliography.author}" size="26" ></p:inputText>
                                        </div>
                                        <div class="form-group col-sm-4">
                                            <p:calendar id="expirationDate" pt:placeholder="Fecha Publicación"
                                                        readonly="#{projectView.stateRevision()}"
                                                        pattern="dd/MM/yyyy" 
                                                        locale="es"
                                                        value="#{bibliography.publicactionYear}"
                                                        >
                                                <f:convertDateTime type="localDate" pattern="dd/MM/yyyy" />
                                            </p:calendar>
                                        </div>
                                        <div class="form-group col-sm-4">
                                            <p:commandLink  styleClass="btn btn-danger" actionListener="#{projectView.project.removeBibliography(bibliographyStatus)}" 
                                                            update="#{p:component('biblioghraphies')}"
                                                            process="#{p:component('biblioghraphies')}"
                                                            rendered="#{projectView.isStuden() and (projectView.process.state!=projectView.revisionState)}"
                                                            >
                                                <span class="glyphicon glyphicon-minus"></span> Eliminar
                                            </p:commandLink>
                                        </div>
                                    </div> 
                                    <div class="row">
                                        <div class="form-group col-sm-4">
                                            <p:inputText readonly="#{projectView.stateRevision()}" placeholder="Titulo" value="#{bibliography.title}" size="26"></p:inputText>
                                        </div>
                                        <div class="form-group col-sm-4">
                                            <p:inputText readonly="#{projectView.stateRevision()}" placeholder="Ciudad" value="#{bibliography.city}" size="26"></p:inputText>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="form-group col-sm-4">
                                            <p:inputText readonly="#{projectView.stateRevision()}" placeholder="Pais" value="#{bibliography.country}" size="26"></p:inputText>
                                        </div>
                                        <div class="form-group col-sm-4">
                                            <p:inputText readonly="#{projectView.stateRevision()}" placeholder="Editorial" value="#{bibliography.editorial}" size="26"></p:inputText>
                                        </div>                                    
                                    </div>
                                </p:dataViewListItem>
                            </p:dataView>
                            <p:commandLink styleClass="btn btn-success" actionListener="#{projectView.project.addBibliography}" update="biblioghraphies"
                                           process="#{p:component('biblioghraphies')}"
                                           rendered="#{projectView.isStuden() and (projectView.process.state!=projectView.revisionState)}"
                                           >
                                <span class="glyphicon glyphicon-plus"></span> Agregar
                            </p:commandLink>
                        </p:panel>
                        <br></br><p:commandLink class="#{projectView.correctionBibliography.style}"
                                                rendered="#{projectView.showButtonRevision(projectView.correctionBibliography)}"
                                                title="Realizar Comentario"
                                                oncomplete="PF('dlgCmt').show();"
                                                update=":#{p:component('dlgCmt')}"
                                                >
                            <f:setPropertyActionListener value="#{projectView.correctionBibliography}" target="#{projectView.correctionSelected}"/>
                            <span class="glyphicon glyphicon-eye-open"></span> #{projectView.textObser}
                        </p:commandLink><br></br><br></br>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-sm-8">
                        <p:outputLabel for="annexed" value="Anexos"/>
                        <p:fileUpload id="annexed" fileUploadListener="#{projectView.handleAnnexed}"
                                      skinSimple="true" auto="true"
                                      rendered="#{projectView.isStuden() and (projectView.process.state!=projectView.revisionState)}"
                                      label="Seleccionar"
                                      update="labelAnnexed"
                                      sizeLimit="15000000"
                                      allowTypes="/(\.|\/)(pdf)$/"
                                      invalidFileMessage="Solo se puede cargar archivos pdf"
                                      invalidSizeMessage="Archivo demasiado grande, limite de 14MB"
                                      >                                       
                        </p:fileUpload>
                        <h:commandLink id="labelAnnexed" value="#{projectView.annexedFileName}" class="text-primary"
                                       target="_blank" actionListener="#{projectView.reloadAnnexed()}">
                            <p:fileDownload value="#{projectView.annexedStream}" contentDisposition="inline"/>
                        </h:commandLink>
                        <br></br><p:commandLink class="#{projectView.correctionAnexo.style}"
                                                rendered="#{projectView.showButtonRevision(projectView.correctionAnexo)}"
                                                title="Realizar Comentario"
                                                oncomplete="PF('dlgCmt').show();"
                                                update=":#{p:component('dlgCmt')}"
                                                >
                            <f:setPropertyActionListener value="#{projectView.correctionAnexo}" target="#{projectView.correctionSelected}"/>
                            <span class="glyphicon glyphicon-eye-open"></span> #{projectView.textObser}
                        </p:commandLink><br></br><br></br>
                    </div>
                </div>
            </fieldset>
            <div class="row">
                <div class="form-group col-sm-2">
                    <p:commandLink styleClass="btn btn-success"
                                   update="@form,:growl"
                                   rendered="#{projectView.showButtonRevision(null)}"
                                   action="#{projectView.finishReview()}">
                        <p:confirm header="Confirmation" message="Esta seguro de rechazar el proyecto?" icon="pi pi-exclamation-triangle" />
                        <span class="glyphicon glyphicon-remove"></span> Rechazar Proyecto
                    </p:commandLink>
                </div>
                <div class="form-group col-sm-2">
                    <p:commandLink styleClass="btn btn-success"
                                   update="@form,:growl"
                                   rendered="#{projectView.showButtonRevision(null)}"
                                   action="#{projectView.acceptChanges()}">
                        <p:confirm header="Confirmation" message="Esta seguro de acpetar el proyecto?" icon="pi pi-exclamation-triangle" />
                        <span class="glyphicon glyphicon-check"></span> Aceptar Proyecto
                    </p:commandLink>
                </div>
                <div class="form-group col-sm-2">
                    <p:commandLink styleClass="btn btn-success"
                                   update="@form,:growl"
                                   rendered="#{projectView.showButtonRevision(null)}"
                                   action="#{projectView.finishReview()}">
                        <p:confirm header="Confirmation" message="Esta seguro de terminar la revision del proyecto?" icon="pi pi-exclamation-triangle" />
                        <span class="glyphicon glyphicon-check"></span> Terminar Revisión
                    </p:commandLink>
                </div>
                <div class="form-group col-sm-2">
                    <p:commandLink styleClass="btn btn-info"
                                   actionListener="#{projectView.createPDF()}"
                                   rendered="#{projectView.showButtonRevision(null)}"
                                   update="openFile, :growl">
                        <span class="glyphicon glyphicon-file"></span> Generar Archivo PDF
                    </p:commandLink>
                </div>
            </div>
            <div class="row">
                <div class="form-group col-sm-2">
                    <p:commandLink styleClass="btn btn-primary"
                                   update="@form,:growl" 
                                   rendered="#{projectView.isStuden()}"
                                   action="#{projectView.uploadCreate()}">
                        <span class="glyphicon glyphicon-floppy-disk"></span> Guardar Proyecto EPS
                    </p:commandLink>
                </div>

                <div class="form-group col-sm-2">
                    <p:commandLink styleClass="btn btn-info"
                                   actionListener="#{projectView.createPDF()}"
                                   rendered="#{projectView.isStuden()}"
                                   update="openFile, :growl">
                        <span class="glyphicon glyphicon-file"></span> Generar Archivo PDF
                    </p:commandLink>
                </div>
                <div class="form-group col-sm-2">
                    <p:commandLink styleClass="btn btn-success"
                                   update="@form,:growl"
                                   rendered="#{projectView.isStuden() and (projectView.process.state!=projectView.revisionState)}"
                                   action="#{projectView.reviewRequeried()}">
                        <p:confirm header="Confirmation" message="Al solicitar la revision ya no se podra editar el proyect. ¿quieres solicitar revision?" icon="pi pi-exclamation-triangle" />
                        <span class="glyphicon glyphicon-check"></span> Solicitar Revisión
                    </p:commandLink>
                </div>
                <div jsf:id="openFile" class="form-group col-sm-2">
                    <h:commandLink id="openPDF" 
                                   styleClass="btn btn-success"
                                   target="_blank"
                                   rendered="#{projectView.pdfFile!=null}"
                                   >
                        <p:fileDownload value="#{projectView.pdfFile}" contentDisposition="inline"/>
                        <span class="glyphicon glyphicon-open-file"></span>Abrir PDF
                    </h:commandLink>
                </div>
            </div>
        </h:form>
        <p:dialog  header="Comentario" id="dlgCmt" widgetVar="dlgCmt"
                   fitViewport="true" modal="true" closeOnEscape="true" position="center">
            <p:ajax event="close" update="@this" listener="#{projectView.clearCorrectionSelected()}"/>
            <h:form>
                <div class="modal-body">
                    <fieldset>
                        <div class="row form-group">
                            <p:scrollPanel  style="max-width:580px;max-height:250px">
                                <span class="border-0"></span>
                                <p:staticMessage  severity="warn" summary="Comentario Anterior:" detail="#{projectView.listCorrection}" />
                            </p:scrollPanel><br></br>
                            <p:inputTextarea  readonly="#{projectView.isStuden()}"  value="#{projectView.correctionSelectedText}" id="cmt" rows="10" cols="80" counter="display" maxlength="10000" counterTemplate="{0} Caracteres Restantes." autoResize="false" />
                            <br/>
                            <h:outputText id="display" /><br></br><br></br>
                            <p:commandLink class="btn btn-primary btn-xs"
                                           styleClass="btn btn-primary btn-xs"
                                           rendered="#{!projectView.isStuden()}"
                                           update="@form,:#{p:component('growl')},:#{p:component('formProject')}"
                                           actionListener="#{projectView.comment('dlgCmt')}">
                                <span class="glyphicon glyphicon-ok"></span> Comentar
                            </p:commandLink>
                        </div>
                    </fieldset>
                </div>
            </h:form>
        </p:dialog>
        <p:dialog  header="Rechazo Proyecto" id="dlgCmtRz" widgetVar="dlgCmtRz"
                   fitViewport="true" modal="true" closeOnEscape="true" position="center">
            <p:ajax event="close" update="@this"/>
            <h:form>
                <div class="modal-body">
                    <fieldset>
                        <p:inputTextarea  value="" id="cmt" rows="10" cols="80" counter="display" maxlength="10000" counterTemplate="{0} Caracteres Restantes." autoResize="false" />
                    </fieldset>
                </div>
            </h:form>
        </p:dialog>
        <p:confirmDialog global="true" showEffect="fade" hideEffect="fade" >
            <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="pi pi-check" />
            <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="pi pi-times" />
        </p:confirmDialog> 
    </ui:define>
</ui:composition>